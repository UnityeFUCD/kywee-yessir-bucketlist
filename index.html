<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>kywee + yessir bucket list</title>

  <!-- ‚úÖ Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

  <!-- ‚úÖ App icon + favicon (iOS + browsers) -->
  <link rel="apple-touch-icon" href="/app-icon.png">
  <link rel="icon" type="image/png" href="/app-icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Bucket List">

  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <span>[‚ñ∏] 2026 BUCKET_LIST.EXE</span>
      </div>

      <div class="topbar-right">
        <button class="btn hidden" id="btnHome">‚óÇ HOME</button>

        <div class="notif-wrap">
          <div class="notification-bell" id="notificationBell" aria-label="Notifications" title="Notifications">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z"/>
            </svg>
            <span class="notification-badge hidden" id="notificationBadge">0</span>
          </div>

          <div class="notification-dropdown" id="notificationDropdown">
            <div class="notification-header">
              <span>NOTIFICATIONS</span>
              <div class="notif-head-actions">
                <button class="notif-mini-btn" id="btnNotifClearAll" title="Mark all read">
                  <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M7 7h10v2H7V7zm0 4h10v2H7v-2zm0 4h6v2H7v-2z"/>
                  </svg>
                </button>
              </div>
            </div>
            <div id="notificationList"></div>
          </div>
        </div>

        <span class="pill clickable" id="userPill" title="Click to switch user">
          <span class="dot gray" id="userDot"></span>
          <span id="userText">USER: --</span>
        </span>

        <span class="pill clickable" id="duoPill" title="Click to view letters from duo">
          <span class="dot gray" id="duoDot"></span>
          <span id="duoText">DUO: --</span>
        </span>

        <span class="pill" id="syncPill" title="Sync status">
          <span class="dot gray" id="syncDot"></span>
          <span>SYNC</span>
        </span>

        <div class="theme-switcher">
          <button class="btn theme-btn" id="themeBtn">THEME</button>
          <div class="theme-dropdown" id="themeDropdown">
            <div class="theme-option active" data-theme="system">System</div>
            <div class="theme-option" data-theme="light">Light</div>
            <div class="theme-option" data-theme="dark">Dark</div>
            <div class="theme-option" data-theme="christmas">Christmas</div>
          </div>
        </div>
      </div>
    </div>

    <section class="cover" id="cover">
      <div class="christmas-lights">
        <div class="light"></div><div class="light"></div><div class="light"></div>
        <div class="light"></div><div class="light"></div><div class="light"></div>
        <div class="light"></div><div class="light"></div><div class="light"></div>
      </div>

      <div class="corner-decor tl"></div>
      <div class="corner-decor tr"></div>
      <div class="corner-decor bl"></div>
      <div class="corner-decor br"></div>

      <div class="coverInner">
        <svg class="heart" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M12 21s-7.2-4.6-9.7-8.9C.5 8.9 2.1 5.8 5.5 5.1c1.7-.3 3.4.3 4.5 1.6 1.1-1.3 2.8-1.9 4.5-1.6 3.4.7 5 3.8 3.2 7-2.5 4.3-9.7 8.9-9.7 8.9Z"
                fill="currentColor" stroke="currentColor" stroke-width="0.5" style="color: var(--accent);"/>
        </svg>

        <h1 class="big">SYSTEM MESSAGE:<br><span id="herName">MY LOVE</span><span class="cursor"></span></h1>

        <p class="sub">[INITIALIZING...] Our bucket list for the new year. Status: WEADY TO DEPLOY.</p>

        <pre class="emoticon-art" id="dailyEmoticon"></pre>

        <div class="actions" style="justify-content:center; margin-top:30px;">
          <button class="btn primary" id="btnOpen">‚ñ∏ INITIALIZE SYSTEM</button>
          <button class="btn" id="btnEditSystemMessage">EDIT SYSTEM MESSAGE</button>
        </div>
      </div>
    </section>

    <section class="grid hidden" id="main">
      <div class="card" style="grid-column: 1 / -1;">
        <div class="cardHeader">
          <h2>[‚ñ∏] 2026 PROGRESS_TRACKER</h2>
          <span class="pill">2026</span>
        </div>
        <div class="cardBody">
          <div class="tracker-grid">
            <div class="tracker-box">
              <div class="tracker-label">CURRENT DATE/TIME</div>
              <div class="tracker-value" id="trackerNow">--</div>
            </div>
            <div class="tracker-box">
              <div class="tracker-label">TIME REMAINING</div>
              <div class="tracker-value" id="trackerRemaining">--</div>
            </div>
            <div class="tracker-box">
              <div class="tracker-label">DAYS ELAPSED</div>
              <div class="tracker-value" id="trackerElapsed">--</div>
            </div>
          </div>
          <div class="tracker-bar" aria-hidden="true">
            <div class="tracker-fill" id="trackerFill"></div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="cardHeader">
          <h2>[‚ñ∏] MISSION_LIST.LOG</h2>

          <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
            <span class="pill" id="yearPill">2026</span>
          </div>
        </div>

        <div class="cardBody">
          <div class="mission-tabs">
            <div class="mission-tab active" data-tab="active">Active Missions</div>
            <div class="mission-tab" data-tab="completed">Completed Missions</div>
          </div>

          <div id="activeTab">
            <div class="note">// STATUS: Items are auto-saved. Check to mark complete.</div>
            <div class="items" id="itemsActive"></div>

            <!-- ‚úÖ Export moved next to Add Saved Mission -->
            <div class="actions actions-inline">
              <button class="btn primary" id="btnAddSaved">ADD SAVED MISSION</button>
              <button class="btn" id="btnDownloadText">EXPORT .TXT</button>
            </div>
          </div>

          <div id="completedTab" class="hidden">
            <div class="note">// COMPLETED: Missions you've finished.</div>
            <div class="items" id="itemsCompleted"></div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="cardHeader">
          <h2>[‚ñ∏] MESSAGE_LOG</h2>
          <div class="envelope-container" id="envelopeBtn" title="Open latest letter from your DUO">
            <span aria-hidden="true">‚úâ</span>
            <span id="envelopeLabel">DUO</span>
          </div>
        </div>

        <div class="cardBody">
          <p class="note" id="loveNote">// SYSTEM MESSAGE: MY LOVE</p>

          <div id="messageLog"></div>

          <div class="form">
            <div class="field">
              <label for="customNote">[‚ñ∏] NEW MESSAGE</label>
              <textarea id="customNote" placeholder="// Enter your message here..." inputmode="text" autocomplete="off" autocapitalize="sentences"></textarea>
            </div>
            
            <!-- ‚úÖ [FEATURE B] Attachment input -->
            <div class="field attachment-field">
              <label for="attachmentInput">üìé ATTACH IMAGE/VIDEO</label>
              <input type="file" id="attachmentInput" accept="image/*,video/*" />
              <div id="attachmentPreview" class="attachment-preview hidden"></div>
            </div>
            
            <button class="btn primary" id="btnSaveNote">SEND LETTER</button>
          </div>

          <hr />

          <div class="field">
            <label>[‚ñ∏] ADD NEW MISSION</label>
            <input id="newTitle" type="text" placeholder="Movie" inputmode="text">
          </div>
          <div class="field">
            <input id="newDesc" type="text" placeholder="pick a movie and location" inputmode="text">
          </div>
          <div class="field">
            <label for="newTag">TAG</label>
            <select id="newTag">
              <option value="date">date</option>
              <option value="travel">travel</option>
              <option value="cozy">cozy</option>
              <option value="food">food</option>
              <option value="home">home</option>
              <option value="romantic">romantic</option>
              <option value="fun">fun</option>
              <option value="tradition">tradition</option>
              <option value="music">music</option>
              <option value="new">new</option>
              <option value="heart">heart</option>
              <option value="custom">Custom...</option>
            </select>
          </div>
          <div class="field hidden" id="customTagField">
            <input id="customTagInput" type="text" placeholder="Enter custom tag" inputmode="text">
          </div>
          <div class="field">
            <label for="newDueDate"><i class="fas fa-calendar"></i> DUE DATE (optional)</label>
            <input id="newDueDate" type="date">
          </div>
          <div class="actions">
            <button class="btn primary" id="btnAdd">+ ADD MISSION</button>
            <button class="btn" id="btnClearFields">CLEAR FIELDS</button>
          </div>

          <div class="footer">[ COMPILED FOR ONE SPECIAL KITTEN ]</div>
        </div>
      </div>

      <!-- ‚úÖ PHOTO MEMORIES GALLERY -->
      <div class="card">
        <div class="cardHeader">
          <h2>[‚ñ∏] MEMORIES_GALLERY</h2>
        </div>
        <div class="cardBody">
          <p class="note">// Max 5 photos per mission. Upload multiple times. Unlinked photos = unlimited.</p>
          
          <div class="photo-upload-section">
            <div class="photo-upload-row">
              <input type="file" id="photoInput" accept="image/*,video/*" multiple hidden>
              <button class="btn" id="photoSelectBtn"><i class="fa-solid fa-upload"></i> Select Photos</button>
              <span class="photo-count-hint" id="photoCountHint"></span>
            </div>
            
            <!-- Staging area for photos before submit -->
            <div id="photoStagingArea" class="photo-staging hidden">
              <div class="staging-header">
                <span>Staged: <span id="stagedCount">0</span> photos</span>
                <span class="staging-capacity" id="stagingCapacity"></span>
                <button class="btn btn-small" id="clearStagingBtn">Clear All</button>
              </div>
              <div id="stagingPreview" class="staging-preview"></div>
              
              <div class="photo-upload-options">
                <div class="field">
                  <label for="photoDate"><i class="fas fa-calendar"></i> Date (required)</label>
                  <input type="date" id="photoDate" required>
                </div>
                <div class="field">
                  <label for="photoMission"><i class="fa-solid fa-link"></i> Link to Completed Mission</label>
                  <select id="photoMission">
                    <option value="">No mission linked</option>
                  </select>
                  <span class="mission-capacity" id="missionCapacity"></span>
                </div>
              </div>
              
              <button class="btn primary" id="photoSubmitBtn"><i class="fa-solid fa-check"></i> Submit Photos</button>
            </div>
          </div>
          
          <div id="photoGallery" class="photo-gallery">
            <!-- Example bundled photos -->
            <div class="gallery-mission-bundle example-bundle">
              <div class="bundle-header">
                <div class="bundle-header-left" onclick="toggleBundle(this.parentElement)">
                  <span class="bundle-mission"><i class="fa-solid fa-link"></i> Example Date Night</span>
                  <span class="bundle-count">3 photos</span>
                </div>
                <div class="bundle-actions">
                  <span class="bundle-expand" onclick="toggleBundle(this.closest('.bundle-header'))"><i class="fas fa-chevron-down"></i></span>
                </div>
              </div>
              <div class="bundle-photos collapsed">
                <div class="gallery-grid">
                  <div class="gallery-item"><img src="https://placehold.co/200x200/1a1a2e/ff6b9d?text=Photo+1" alt="Example"></div>
                  <div class="gallery-item"><img src="https://placehold.co/200x200/1a1a2e/ff6b9d?text=Photo+2" alt="Example"></div>
                  <div class="gallery-item"><img src="https://placehold.co/200x200/1a1a2e/ff6b9d?text=Photo+3" alt="Example"></div>
                </div>
              </div>
            </div>
            <div class="gallery-empty-note">‚Üë Click to expand. Your memories will appear below.</div>
          </div>
        </div>
      </div>

      <!-- ‚úÖ MEDAL CLIPS FEED -->
      <div class="card">
        <div class="cardHeader">
          <h2>[‚ñ∏] MEDAL_CLIPS</h2>
          <button class="btn" id="refreshMedal" title="Refresh clips"><i class="fa fa-refresh"></i></button>
        </div>
        <div class="cardBody">
          <p class="note">// Clips on my Medal account :3</p>
          
          <div id="medalClips" class="medal-grid">
            <div class="medal-empty">Loading clips...</div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <div class="modal" id="savedMissionsModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Saved Missions Database</h3>
        <span class="modal-close" id="closeSavedModal">‚úñ</span>
      </div>
      <div id="savedMissionsList"></div>
      <div class="actions">
        <button class="btn primary" id="btnAddSelectedMissions">ADD SELECTED TO ACTIVE</button>
      </div>
    </div>
  </div>

  <div class="letter-modal" id="letterModal">
    <div class="letter-envelope">
      <div class="letter-close" id="closeLetterModal">‚úñ</div>
      <!-- ‚úÖ Navigation for TikTok-style swipe -->
      <div class="letter-nav">
        <button class="letter-nav-btn" id="letterPrev" title="Newer letter">‚ñ≤</button>
        <span class="letter-counter" id="letterCounter">1 / 1</span>
        <button class="letter-nav-btn" id="letterNext" title="Older letter">‚ñº</button>
      </div>
      <div class="letter-paper">
        <div class="letter-from">FROM: <span id="letterFrom">--</span></div>
        <div class="letter-timestamp" id="letterTimestamp"></div>
        <div class="letter-content" id="letterContent"></div>
        <!-- ‚úÖ Attachment display in letter -->
        <div id="letterAttachment" class="letter-attachment hidden"></div>
        <!-- ‚úÖ Swipe hint INSIDE paper, moves with content -->
        <div class="letter-swipe-hint">‚Üï SWIPE TO BROWSE LETTERS</div>
      </div>
    </div>
  </div>

  <!-- ‚úÖ [FEATURE B] Fullscreen attachment modal -->
  <div class="modal attachment-modal" id="attachmentModal">
    <div class="attachment-modal-inner">
      <span class="modal-close" id="closeAttachmentModal">‚úñ</span>
      <div id="attachmentModalContent"></div>
    </div>
  </div>

  <!-- ‚úÖ Photo Lightbox Modal -->
  <div class="lightbox-modal" id="photoLightbox">
    <div class="lightbox-close" id="lightboxClose">‚úñ</div>
    <div class="lightbox-nav">
      <button class="lightbox-btn" id="lightboxPrev">‚óÄ</button>
      <span class="lightbox-counter" id="lightboxCounter">1 / 1</span>
      <button class="lightbox-btn" id="lightboxNext">‚ñ∂</button>
    </div>
    <img id="lightboxImage" src="" alt="Photo">
    <div class="lightbox-hint">‚Üê Swipe to browse ‚Üí</div>
  </div>

  <!-- ‚úÖ Medal Clip Modal -->
  <div class="modal medal-modal" id="medalModal">
    <div class="medal-modal-inner">
      <span class="modal-close" id="medalModalClose">‚úñ</span>
      <div id="medalModalContent"></div>
    </div>
  </div>

  <div class="modal" id="whoModal" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3>WHO ARE YOU?</h3>
        <span class="modal-close" id="closeWhoModal">‚úñ</span>
      </div>

      <div class="who-grid">
        <button class="who-btn" id="btnWhoYasir">
          <span>YASIR</span>
          <span class="itag">USER</span>
        </button>

        <button class="who-btn" id="btnWhoKylee">
          <span>KYLEE</span>
          <span class="itag">USER</span>
        </button>
      </div>

      <div class="who-sub">
        This site auto-syncs (system message, missions, messages) across devices.
      </div>

      <div class="who-actions">
        <button class="btn" id="btnLogOff">LOG OFF</button>
      </div>
    </div>
  </div>
  
  <!-- ‚úÖ System message edit modal with character counter -->
  <div class="modal" id="systemMessageModal" aria-hidden="true">
    <div class="modal-content">
      <div class="modal-header">
        <h3>EDIT SYSTEM MESSAGE</h3>
        <span class="modal-close" id="closeSystemMessageModal">‚úñ</span>
      </div>

      <div class="field">
        <label for="systemMessageInput">SYSTEM MESSAGE <span id="charCounter" style="float:right; color: var(--muted);">0 / 30</span></label>
        <input id="systemMessageInput" type="text" maxlength="30" placeholder="My love" autocomplete="off" inputmode="text" />
      </div>

      <div class="actions">
        <button class="btn" id="btnSystemMessageCancel">Cancel</button>
        <button class="btn primary" id="btnSystemMessageSave">Save</button>
      </div>
    </div>
  </div>


  <script src="app.js" defer></script>
</body>
</html>